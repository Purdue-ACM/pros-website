

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Filtering &mdash; PROS for V5 3.1.0 documentation</title>
  

  
  
    <link rel="shortcut icon" href="../../../_static/favicon.ico"/>
  
  
  

  

  
  
    

  

  
  
    <link rel="stylesheet" href="../../../_static/css/theme.css" type="text/css" />
  

<link rel="stylesheet" href="../../../_static/pygments.css" type="text/css" />

  

  
        <link rel="index" title="Index"
              href="../../../genindex.html"/>
        <link rel="search" title="Search" href="../../../search.html"/>
    <link rel="top" title="PROS for V5 3.1.0 documentation" href="../../../index.html"/>
        <link rel="up" title="Tutorials" href="../index.html"/>
        <link rel="next" title="Iterative and Async Controllers" href="iterative-async-controllers.html"/>
        <link rel="prev" title="Factory Object Creation Pattern" href="factories.html"/>
   
  
  
  <style type="text/css">
    ul.ablog-archive {list-style: none; overflow: auto; margin-left: 0px}
    ul.ablog-archive li {float: left; margin-right: 5px; font-size: 80%}
    ul.postlist a {font-style: italic;}
    ul.postlist-style-disc {list-style-type: disc;}
    ul.postlist-style-none {list-style-type: none;}
    ul.postlist-style-circle {list-style-type: circle;}
  </style>


  
  <script src="../../../_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">

   
  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="../../../index.html" class="icon icon-home"> PROS for V5
          

          
            
            <img src="../../../_static/logo.svg" class="logo" />
          
          </a>

          
            
            
              <div class="version">
                
                  V5 (3.1.0)
                
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Home</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../index.html">PROS: Documentation Home</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../blog/index.html">Blog</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../releases/index.html">Version Release Notes</a></li>
</ul>
<p class="caption"><span class="caption-text">Getting Started</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../getting-started/index.html">Getting Started</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../getting-started/new-users.html">PROS First Time Users Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../getting-started/installation.html">Installation Guides</a></li>
</ul>
<p class="caption"><span class="caption-text">Tutorials</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../tutorials/index.html">Tutorials</a></li>
</ul>
<p class="caption"><span class="caption-text">API</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../api/index.html">API Home</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../api/c/index.html">C API</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../api/cpp/index.html">C++ API</a></li>
</ul>
<p class="caption"><span class="caption-text">Tools</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../cli/index.html">CLI</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../editor/index.html">Editor</a></li>
</ul>
<p class="caption"><span class="caption-text">OkapiLib</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="../../index.html">OkapiLib Documentation Home</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../../api/index.html">OkapiLib API</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="../index.html">Tutorials</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="../index.html#walkthrough-tutorials">Walkthrough Tutorials</a></li>
<li class="toctree-l3 current"><a class="reference internal" href="../index.html#topical-tutorials">Topical Tutorials</a><ul class="current">
<li class="toctree-l4"><a class="reference internal" href="2dmotionprofiling.html">2D Motion Profiling</a></li>
<li class="toctree-l4"><a class="reference internal" href="chassiscontroller.html">What is a ChassisController, and why is it important?</a></li>
<li class="toctree-l4"><a class="reference internal" href="controller-io.html">Controller Inputs and Outputs</a></li>
<li class="toctree-l4"><a class="reference internal" href="factories.html">Factory Object Creation Pattern</a></li>
<li class="toctree-l4 current"><a class="current reference internal" href="#">Filtering</a><ul>
<li class="toctree-l5"><a class="reference internal" href="#filtering-generic-sensor-input">Filtering Generic Sensor Input</a></li>
<li class="toctree-l5"><a class="reference internal" href="#adding-a-filter-to-a-controller">Adding a Filter to a Controller</a></li>
</ul>
</li>
<li class="toctree-l4"><a class="reference internal" href="iterative-async-controllers.html">Iterative and Async Controllers</a></li>
<li class="toctree-l4"><a class="reference internal" href="settled-util.html">SettledUtils</a></li>
<li class="toctree-l4"><a class="reference internal" href="smart-pointers.html">Smart Pointers</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1 current"><a class="reference internal" href="../index.html">Tutorials</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../index.html#walkthrough-tutorials">Walkthrough Tutorials</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="../index.html#topical-tutorials">Topical Tutorials</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="2dmotionprofiling.html">2D Motion Profiling</a></li>
<li class="toctree-l3"><a class="reference internal" href="chassiscontroller.html">What is a ChassisController, and why is it important?</a></li>
<li class="toctree-l3"><a class="reference internal" href="controller-io.html">Controller Inputs and Outputs</a></li>
<li class="toctree-l3"><a class="reference internal" href="factories.html">Factory Object Creation Pattern</a></li>
<li class="toctree-l3 current"><a class="current reference internal" href="#">Filtering</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#filtering-generic-sensor-input">Filtering Generic Sensor Input</a></li>
<li class="toctree-l4"><a class="reference internal" href="#adding-a-filter-to-a-controller">Adding a Filter to a Controller</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="iterative-async-controllers.html">Iterative and Async Controllers</a></li>
<li class="toctree-l3"><a class="reference internal" href="settled-util.html">SettledUtils</a></li>
<li class="toctree-l3"><a class="reference internal" href="smart-pointers.html">Smart Pointers</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../api/index.html">OkapiLib API</a></li>
</ul>
<p class="caption"><span class="caption-text">Extended (Advanced Users)</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../extended/index.html">Extended API Topics</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../../index.html">PROS for V5</a>
        
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../../../index.html">Docs</a> &raquo;</li>
        
          <li><a href="../../index.html">OkapiLib Documentation Home</a> &raquo;</li>
        
          <li><a href="../index.html">Tutorials</a> &raquo;</li>
        
      <li>Filtering</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            
              <a href="https://github.com/purduesigbots/pros-docs/blob/master/v5/okapi/tutorials/concepts/filtering.rst" class="fa fa-github"> Edit on GitHub</a>
            
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="filtering">
<h1>Filtering<a class="headerlink" href="#filtering" title="Permalink to this headline">¶</a></h1>
<p>OkapiLib makes it easy to use any one of a number of various types of filters on sensors and controllers.
The specifics of how each filter works and should be initialized will be left to its API reference,
but this guide will help provide the general knowledge necessary to make the most out of OkapiLib’s
filtering functionality.</p>
<div class="section" id="filtering-generic-sensor-input">
<h2>Filtering Generic Sensor Input<a class="headerlink" href="#filtering-generic-sensor-input" title="Permalink to this headline">¶</a></h2>
<p>It’s possible with OkapiLib to filter any value that you want, which makes it easy to filter sensors.
The example below gives an example of filtering a sensor value.</p>
<div class="highlight-cpp notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="k">using</span> <span class="k">namespace</span> <span class="n">okapi</span><span class="p">;</span>

<span class="k">const</span> <span class="kt">int</span> <span class="n">POTENTIOMETER_PORT</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
<span class="k">const</span> <span class="kt">int</span> <span class="n">NUM_AVE_POINTS</span> <span class="o">=</span> <span class="mi">5</span><span class="p">;</span>

<span class="n">Potentiometer</span> <span class="nf">exampleSensor</span><span class="p">(</span><span class="n">POTENTIOMETER_PORT</span><span class="p">);</span>
<span class="n">AverageFilter</span><span class="o">&lt;</span><span class="n">NUM_AVE_POINTS</span><span class="o">&gt;</span> <span class="n">exampleFilter</span><span class="p">;</span>

<span class="k">while</span> <span class="p">(</span><span class="nb">true</span><span class="p">)</span> <span class="p">{</span>
  <span class="n">std</span><span class="o">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s">&quot;Current Sensor Reading: &quot;</span> <span class="o">&lt;&lt;</span> <span class="n">exampleFilter</span><span class="p">.</span><span class="n">filter</span><span class="p">(</span><span class="n">exampleSensor</span><span class="p">.</span><span class="n">get</span><span class="p">());</span>
  <span class="n">pros</span><span class="o">::</span><span class="n">Task</span><span class="o">::</span><span class="n">delay</span><span class="p">(</span><span class="mi">10</span><span class="p">);</span>
<span class="p">}</span>
</pre></div>
</td></tr></table></div>
<p>The above example will print out the average of the last five readings of the potentiometer.</p>
</div>
<div class="section" id="adding-a-filter-to-a-controller">
<h2>Adding a Filter to a Controller<a class="headerlink" href="#adding-a-filter-to-a-controller" title="Permalink to this headline">¶</a></h2>
<p>Velocity PID Controllers often benefit from filtering the velocity reading. As a result, it is possible
to pass in a filter as an argument to the constructor for a Velocity PID Controller. Note – filtering
will not have a positive impact on Position PID movements, and is not supported as a result.</p>
<p>Using a filter with a Velocity PID Controller can be done in the following manner:</p>
<div class="highlight-cpp notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="k">using</span> <span class="k">namespace</span> <span class="n">okapi</span><span class="p">;</span>

<span class="k">const</span> <span class="kt">double</span> <span class="n">kP</span> <span class="o">=</span> <span class="mf">1.0</span><span class="p">;</span>
<span class="k">const</span> <span class="kt">double</span> <span class="n">kD</span> <span class="o">=</span> <span class="mf">0.1</span><span class="p">;</span>
<span class="k">const</span> <span class="kt">double</span> <span class="n">kF</span> <span class="o">=</span> <span class="mf">0.0</span><span class="p">;</span>
<span class="k">const</span> <span class="kt">double</span> <span class="n">kSF</span> <span class="o">=</span> <span class="mf">0.0</span><span class="p">;</span>
<span class="k">const</span> <span class="kt">int</span> <span class="n">NUM_AVE_POINTS</span> <span class="o">=</span> <span class="mi">5</span><span class="p">;</span>

<span class="k">auto</span> <span class="n">velMathArgs</span> <span class="o">=</span> <span class="n">VelMathArgs</span><span class="p">(</span><span class="n">imev5TPR</span><span class="p">,</span> <span class="n">std</span><span class="o">::</span><span class="n">make_shared</span><span class="o">&lt;</span><span class="n">AverageFilter</span><span class="o">&lt;</span><span class="n">NUM_AVE_POINTS</span><span class="o">&gt;&gt;</span><span class="p">());</span>
<span class="k">auto</span> <span class="n">exampleController</span> <span class="o">=</span> <span class="n">IterativeControllerFactory</span><span class="o">::</span><span class="n">velPID</span><span class="p">(</span><span class="n">kP</span><span class="p">,</span> <span class="n">kD</span><span class="p">,</span> <span class="n">kF</span><span class="p">,</span> <span class="n">kSF</span><span class="p">,</span> <span class="n">velMathArgs</span><span class="p">);</span>
</pre></div>
</td></tr></table></div>
<p>To clarify step by step:</p>
<p>First a <code class="docutils literal notranslate"><span class="pre">VelMath</span></code> object needs to be created. This is used to calculate the motor’s velocity for
use by the controller. The <code class="docutils literal notranslate"><span class="pre">imeV5TPR</span></code> value is the number of Ticks Per Revolution of the motor’s
internal encoder, and is defined by OkapiLib. The <code class="docutils literal notranslate"><span class="pre">std::make_shared&lt;AverageFilter&lt;5&gt;&gt;()</span></code> portion
creates a Smart Pointer to an <code class="docutils literal notranslate"><span class="pre">AverageFilter</span></code> object that averages the last 5 values. Note that
the <code class="docutils literal notranslate"><span class="pre">AverageFilter&lt;NUM_AVE_POINTS&gt;</span></code> portion is identical to the first code example.</p>
<p>The <code class="docutils literal notranslate"><span class="pre">VelMath</span></code> pointer, along with the PID constants, are then passed to the <code class="docutils literal notranslate"><span class="pre">IterativeControllerFactory</span></code>
to create a <code class="docutils literal notranslate"><span class="pre">IterativeVelPIDController</span></code> object.</p>
</div>
</div>

  <div class="section">
  
  
  </div>

           </div>
           <div class="articleComments">
            
           </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="iterative-async-controllers.html" class="btn btn-neutral float-right" title="Iterative and Async Controllers" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="factories.html" class="btn btn-neutral" title="Factory Object Creation Pattern" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2018, Purdue ACM SIGBots. Released under the MPL 2.0 license.

    </p>
  </div> 

</footer>

        </div>
      </div>

    </section>

  </div>
  

  <div class="rst-versions" data-toggle="rst-versions" role="note" aria-label="versions">
    <span class="rst-current-version" data-toggle="rst-current-version">
      <span class="fa fa-book"> Versions: </span>
      v: V5 (3.1.0)
      <span class="fa fa-caret-down"></span>
    </span>
    <div class="rst-other-versions">
      <dl>
        <dt>Versions</dt>
        
          <dd><a href="../../../index.html">V5</a></dd>
        
          <dd><a href="../../../../cortex/index.html">Cortex</a></dd>
        
      </dl>
    </div>
  </div>


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'../../../',
            VERSION:'3.1.0',
            LANGUAGE:'None',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true,
            SOURCELINK_SUFFIX: '.txt'
        };
    </script>
      <script type="text/javascript" src="../../../_static/jquery.js"></script>
      <script type="text/javascript" src="../../../_static/underscore.js"></script>
      <script type="text/javascript" src="../../../_static/doctools.js"></script>

  

  
  
    <script type="text/javascript" src="../../../_static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
  
 
<script type="text/javascript">
var gaJsHost = (("https:" == document.location.protocol) ? "https://ssl." : "http://www.");
document.write(unescape("%3Cscript src='" + gaJsHost + "google-analytics.com/ga.js' type='text/javascript'%3E%3C/script%3E"));
</script>
<script type="text/javascript">
try {
var pageTracker = _gat._getTracker("UA-84548828-3");
pageTracker._trackPageview();
} catch(err) {}</script>


</body>
</html>