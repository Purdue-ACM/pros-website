<!DOCTYPE html>
  
  
  
  
   <html class="no-js"> 

  <head lang="en-us">
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,user-scalable=no,initial-scale=1,maximum-scale=1">
    <meta http-equiv="X-UA-Compatible" content="IE=10" />
    <title>PROS - I2C Communication</title>
    <meta name="generator" content="Hugo 0.17" />

    
    <meta name="description" content="An open source programming environment for the VEX EDR Platform">
    
    <link rel="canonical" href="http://pros.cs.purdue.edu/tutorials/i2c/">
    
    <meta name="author" content="purduesigbots">
    

    <meta property="og:url" content="http://pros.cs.purdue.edu/tutorials/i2c/">
    <meta property="og:title" content="PROS">
    <meta property="og:image" content="http://pros.cs.purdue.edu/images/logo.png">
    <meta name="apple-mobile-web-app-title" content="PROS">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">

    <link rel="shortcut icon" type="image/x-icon" href="http://pros.cs.purdue.edu/images/favicon.ico">
    <link rel="icon" type="image/x-icon" href="http://pros.cs.purdue.edu/images/favicon.ico">

    <style>
      @font-face {
        font-family: 'Icon';
        src: url('http://pros.cs.purdue.edu/fonts/icon.eot?52m981');
        src: url('http://pros.cs.purdue.edu/fonts/icon.eot?#iefix52m981')
               format('embedded-opentype'),
             url('http://pros.cs.purdue.edu/fonts/icon.woff?52m981')
               format('woff'),
             url('http://pros.cs.purdue.edu/fonts/icon.ttf?52m981')
               format('truetype'),
             url('http://pros.cs.purdue.edu/fonts/icon.svg?52m981#icon')
               format('svg');
        font-weight: normal;
        font-style: normal;
      }
    </style>

    <link rel="stylesheet" href="http://pros.cs.purdue.edu/stylesheets/application.css">
    <link rel="stylesheet" href="http://pros.cs.purdue.edu/stylesheets/temporary.css">

    <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.7.0/styles/atom-one-dark.min.css">
    <script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.7.0/highlight.min.js"></script>
    <script>hljs.initHighlightingOnLoad();</script>

    
    
    
    <link rel="stylesheet" href="//fonts.googleapis.com/css?family=Montserrat:400,700|Ubuntu&#43;Mono">
    <style>
      body, input {
        font-family: 'Montserrat', Helvetica, Arial, sans-serif;
      }
      pre, code {
        font-family: 'Ubuntu Mono', 'Courier New', 'Courier', monospace;
      }
    </style>

    
    <link rel="stylesheet" href="http://pros.cs.purdue.edu/stylesheets/api.css">
    
    <script src="http://pros.cs.purdue.edu/javascripts/modernizr.js"></script>

    

  </head>
  <body>



	
	


<div class="backdrop">
	<div class="backdrop-paper"></div>
</div>

<input class="toggle" type="checkbox" id="toggle-drawer">
<input class="toggle" type="checkbox" id="toggle-search">
<label class="toggle-button overlay" for="toggle-drawer"></label>

<header class="header">
	<nav aria-label="Header">
  <div class="bar default">
    <div class="button button-menu" role="button" aria-label="Menu">
      <label class="toggle-button icon icon-menu" for="toggle-drawer">
        <span></span>
      </label>
    </div>
    <div class="stretch">
      <div class="title">
        I2C Communication
      </div>
    </div>

    

    
    <div class="button button-github" role="button" aria-label="GitHub">
      <a href="https://github.com/purduesigbots" title="@purduesigbots on GitHub" target="_blank" class="toggle-button icon icon-github"></a>
    </div>
    
    
        
  </div>
  <div class="bar search">
    <div class="button button-close" role="button" aria-label="Close">
      <label class="toggle-button icon icon-back" for="toggle-search"></label>
    </div>
    <div class="stretch">
      <div class="field">
        <input class="query" type="text" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck>
      </div>
    </div>
    <div class="button button-reset" role="button" aria-label="Search">
      <button class="toggle-button icon icon-close" id="reset-search"></button>
    </div>
  </div>
</nav>
</header>

<main class="main">
	<div class="drawer">
		<nav aria-label="Navigation">
  <a href="https://github.com/purduesigbots/pros" class="project">
    <div class="banner">
      
        <div class="logo">
          <img src="http://pros.cs.purdue.edu/images/logo.png">
        </div>
      
      <div class="name">
        <strong>PROS <span class="version">2.11.0</span></strong>
        
          <br>
          purduesigbots/pros
        
      </div>
    </div>
  </a>

  <div class="scrollable">
    <div class="wrapper">
      
        <ul class="repo">
          <li class="repo-download">
            <a href="https://github.com/purduesigbots/pros/releases" target="_blank" title="Download" data-action="download">
              <i class="icon icon-download"></i> Download
            </a>
          </li>
          <li class="repo-stars">
            <a href="https://github.com/purduesigbots/pros/stargazers" target="_blank" title="Stargazers" data-action="star">
              <i class="icon icon-star"></i> Stars
              <span class="count">&ndash;</span>
            </a>
          </li>
        </ul>
        <hr>
      

      <div class="toc">
        
        <ul>
          




<li>
  
    



<a  title="Home" href="http://pros.cs.purdue.edu/">
	
	Home
</a>



  
</li>



<li>
  
    



<a  title="Download" href="http://pros.cs.purdue.edu/download/">
	
	Download
</a>



  
</li>



<li>
  
    



<a  title="Getting started" href="http://pros.cs.purdue.edu/getting-started/">
	
	Getting started
</a>



  
</li>



<li>
  
    



<a  title="Tutorials" href="http://pros.cs.purdue.edu/tutorials/">
	
	Tutorials
</a>



    <ul>
      
        
        



<a  title="Debugging" href="http://pros.cs.purdue.edu/tutorials/debugging/">
	
	Debugging
</a>



      
        
        



<a  title="Encoders" href="http://pros.cs.purdue.edu/tutorials/encoders/">
	
	Encoders
</a>



      
        
        



<a  title="Digital Input" href="http://pros.cs.purdue.edu/tutorials/digitalRead/">
	
	Digital Input
</a>



      
        
        



<a  title="Analog Sensors" href="http://pros.cs.purdue.edu/tutorials/analog/">
	
	Analog Sensors
</a>



      
        
        



<a  title="Pneumatics" href="http://pros.cs.purdue.edu/tutorials/pneumatics/">
	
	Pneumatics
</a>



      
        
        



<a  title="Ultrasonic" href="http://pros.cs.purdue.edu/tutorials/ultrasonic/">
	
	Ultrasonic
</a>



      
        
        



<a  title="LCD Screen" href="http://pros.cs.purdue.edu/tutorials/lcd/">
	
	LCD Screen
</a>



      
        
        



<a  title="Tasks/Multithreading" href="http://pros.cs.purdue.edu/tutorials/tasks/">
	
	Tasks/Multithreading
</a>



      
        
        



<a class="current" title="I2C Communication" href="http://pros.cs.purdue.edu/tutorials/i2c/">
	
	I2C Communication
</a>


<ul id="scrollspy">
</ul>


      
        
        



<a  title="Coding FAQ" href="http://pros.cs.purdue.edu/tutorials/coding-faq/">
	
	Coding FAQ
</a>



      
    </ul>
  
</li>



<li>
  
    



<a  title="API" href="http://pros.cs.purdue.edu/api/">
	
	API
</a>



  
</li>



<li>
  
    



<a  title="Known Issues" href="http://pros.cs.purdue.edu/known-issues/">
	
	Known Issues
</a>



  
</li>



<li>
  
    



<a  title="License" href="http://pros.cs.purdue.edu/license/">
	
	License
</a>



  
</li>


        </ul>
        

        
        <hr>
        <span class="section">Get in touch</span>

        <ul>
          

          
          <li>
            <a href="https://github.com/purduesigbots" target="_blank" title="@purduesigbots on GitHub">
              @purduesigbots on GitHub
            </a>
          </li>
          

          
          <li>
            <a href="mailto:pros_development@cs.purdue.edu%20%20" title="Email of pros_development@cs.purdue.edu  ">
              Contact via email
            </a>
          </li>
          
        </ul>
        
      </div>
    </div>
  </div>
</nav>

	</div>

	<article class="article">
		<div class="wrapper">
			<h1>I2C Communication </h1>

			

<p>Inter-Integrated Circuit or I2C communications is but one of the common embedded communications protocols found commonly in robotics at large.  It sports a master-slave configuration as well as a unified bus allowing devices to be daisy-chained together in series if so desired.  A standard I2C bus consists of two signals seen by all devices - Serial Data (SDA) and Serial Clock (SCL).  These two signals are found alongisde +5V and GND power rails in the VEX Cortex I2C port to supply power to any attached I2C slave devices.</p>

<p>The primary I2C device encountered in VEX is the <a href="http://www.vexrobotics.com/encoder-modules.html">Integrated Motor Encoder (IME)</a>; VEX U teams or hobbyists may feel so inclined to connect third-party I2C sensors to their robots such as gyroscopes or lidars.  This tutorial aims to cover writing to and reading from I2C slave devices, a rundown of the IME-specific functions provided, and transisition into topics such as device initialization and polling tasks for managing multiple I2C slaves at once.</p>

<p>In a future update this tutorial will strive to provide a brief summary of the I2C protocol itself, but in lieu of our own take on the subject please review the excellent rundown provided by SparkFun located <a href="https://learn.sparkfun.com/tutorials/i2c">here</a>.</p>

<h2 id="writing-to-an-i2c-slave">Writing to an I2C Slave</h2>

<p>PROS low-level and initialization functions establish the VEX Cortex as an I2C master device, thus the primary I2C action it will perform is writing to I2C slave devices attached to it.  During I2C slave initialization and operation it is common to modify single byte registers in non-sequential locations of the slave&rsquo;s memory.  In these cases PROS provides the <a href="http://pros.cs.purdue.edu/api/#i2cWriteRegister">i2cWriteRegister()</a>.  A sister function <a href="http://pros.cs.purdue.edu/api/#i2cWrite">i2cWrite()</a> is better used when writing to sequential bytes of an I2C slave such as providing full 32-bit integer parameters.  When using <a href="http://pros.cs.purdue.edu/api/#i2cWrite">i2cWrite()</a> the first byte of the data argument should be the first register of the slave being written to.  Shown below is a short example of initializing and configuring a fictional I2C slave sensor.</p>

<p>main.h</p>

<pre><code class="language-c">// 7-bit address of the slave I2C device, right aligned
#define I2C_SLAVE_ADDR         0x4A
// Ficitonal &quot;enable&quot; register for the device
#define I2C_SLAVE_REG_ENABLE   0x38
// Fictional 32-bit &quot;parameters&quot; buffer for the device, 0x6D-0x6F
#define I2C_SLAVE_BUF_PARAMS   0x6D
</code></pre>

<p>init.c</p>

<pre><code class="language-c">#include &quot;main.h&quot;

void initialize() {
    // Note the address of the first register of the buffer is first in the message
    uint8_t params[5] = {I2C_SLAVE_BUF_PARAMS, 0x50, 0x52, 0x79, 0x53};

    // Send the slave some parameters
    if (i2cWrite(I2C_SLAVE_ADDR, params, 5)) {
        printf(&quot;Parameters sent successfully!\n&quot;);
    }
    else {
        printf(&quot;ERROR: Failed to send parameters to I2C slave!\n&quot;);
    }

    // And then enable the device
    if (i2cWriteRegister(I2C_SLAVE_ADDR, I2C_I2C_SLAVE_REG_ENABLE, 0x01)) {
        printf(&quot;I2C slave enabled!\n&quot;);
    }
    else {
        printf(&quot;ERROR: Failed to enable the I2C slave!\n&quot;);
    }
}
</code></pre>

<h2 id="reading-from-an-i2c-slave">Reading from an I2C Slave</h2>

<p>As the vast majority of I2C slave devices serve as sensors, PROS provides both <a href="http://pros.cs.purdue.edu/api/#i2cRead">i2cRead()</a> and <a href="http://pros.cs.purdue.edu/api/#i2cReadRegister">i2cReadRegister()</a> to receive data from them.  Since I2C slave devices do not emit data onto the bus without the request of the master device, <a href="http://pros.cs.purdue.edu/api/#i2cRead">i2cRead()</a> is limited in its usefulness.  To that extent, below is an example showing how to read from data from a fictional sensor using the more typical <a href="http://pros.cs.purdue.edu/api/#i2cReadRegister">i2cReadRegister()</a>.</p>

<p>main.h</p>

<pre><code class="language-c">// 7-bit address of the slave I2C device, right aligned
#define I2C_SLAVE_ADDR       0x4A
// Fictional 32-bit data buffer for the device, 0x30-0x34
#define I2C_SLAVE_BUF_DATA   0x30
</code></pre>

<p>auto.c</p>

<pre><code class="language-c">#include &quot;main.h&quot;

void autonomous() {
    uint8_t dataIn[4];
    int32_t reading = -1;

    while (1) {
        if (i2cReadRegister(I2C_SLAVE_ADDR, I2C_SLAVE_BUF_DATA, data_in, 4)) {
            // Combine the 8-bit incoming values by extending them and bitwise-oring them together
            //
            // NOTE: Extension to 32-bits is done using uint32_t even though reading is int32_t
            //       This is done to prevent &quot;sign extension,&quot; a common problem in these scenarios
            //
            // NOTE: This implementation assumes incoming data is big-endian with the order (0, 1, 2, 3)
            //       If your I2C slave emits data as little-endian, the order needs to be reversed
            reading = (((uint32_t)dataIn[0]) &lt;&lt; 24) |
                      (((uint32_t)dataIn[1]) &lt;&lt; 16) |
                      (((uint32_t)dataIn[2]) &lt;&lt;  8) |
                      (((uint32_t)dataIn[3]));

            printf(&quot;Read in a value of %d from slave.\n&quot;, reading);
        }
        else {
            reading = -1;
            printf(&quot;ERROR: Failed to read sensor data from slave!\n&quot;);
        }

        // Use the sensor value in some way here

        delay(20);
    }
}
</code></pre>

<h2 id="vex-integrated-motor-encoder-ime">VEX Integrated Motor Encoder (IME)</h2>

<p>IMEs function a lot like the quadrature encoders except they are directly attached to the motor rather than mounted to a mechanism on your robot. In addition these sensors utilize the I2C bus on the cortex and can be daisy chained together on your robot.</p>

<h3 id="advance-user-warning">Advance User Warning</h3>

<p>When utilizing IMEs and 3rd party sensors on your I2C bus it is recommended that you write your own task to handle all the I2C communication to prevent resource thrashing. See the <a href="http://pros.cs.purdue.edu/tutorials/i2c/#pollingTask">I2C Polling Task</a> for more details.</p>

<p>PROS provides a simple library for interacting with your IMEs. A sample usage would be as follows:</p>

<p>main.h:</p>

<pre><code class="language-c">#define IME_LEFT_MOTOR 0
#define IME_RIGHT_MOTOR 1
#define NUMBER_OF_IME 2
</code></pre>

<p>init.c:</p>

<pre><code class="language-c">void initialize(){
    // ...
    // Check count to ensure all IMEs are plugged in!
    int IMECount = imeInitializeAll();
    if(IMECount != NUMBER_OF_IME){
        // something has gone wrong
    }
}
</code></pre>

<p>opcontrolc or auto.c:</p>

<pre><code class="language-c">void myFunction(){
    // ... do work
    // Get IME tick count in the &quot;counts&quot; variable
    // (conversion to rotations varies depending on the motor type in use)
    int counts;
    imeGet(0, &amp;counts);

    // Or if #define was used:
    imeGet(IME_LEFT_MOTOR, &amp;counts);

    // ... Do other work
    // Reset IME to zero
    imeReset(IME_RIGHT_MOTOR);
}
</code></pre>

<h2 id="third-party-i2c-devices">Third-Party I2C Devices</h2>

<!--- TODO mention consulting datasheets -->

<p>Writing to and reading from third-party I2C devices with the Cortex using PROS is a relatively painless process with the techniques described earlier in this tutorial.  PROS essentially only requires the 7-bit I2C address of the target slave and a register you wish to interact with if any.  These can all be found in the third-party device&rsquo;s datasheet.</p>

<p>The great deal of effort in connecting a third-party I2C slave comes in scouring its datasheet and synthesizing its instructions into a device driver.  A critical aspect of this driver is its initialization routine.  Since I2C slave sensors often have their own microprocessors present, they may require several registers to be configured and an enable register to be set before they will even begin collecting data.  It is recommended that a <code>Xinit()</code> function be created for sensor X (e.g. lidarInit, gyroInit, etc) so that it may be called from different locations in the robot code rather than hard-coding the setup protocol into <code>init.c</code>.  This way if the device were to ever lose power or disconnect a reconnection attempt is feasible.  This <code>Xinit()</code> function will contain several calls to <a href="http://pros.cs.purdue.edu/api/#i2cWriteRegister">i2cWriteRegister()</a> and <a href="http://pros.cs.purdue.edu/api/#i2cReadRegister">i2cReadRegister()</a> that follow the datasheet&rsquo;s instructions to bring the sensor up and running.</p>

<p>In addition to an initialization routine for the third-party sensor, it is good practice to group multiple sequential write/read operations into routines as well.  This can drastically improve code readability and portability to future robots.  A simple device driver for a fictional lidar is given below.</p>

<p>lidar.h</p>

<pre><code class="language-c">// The 7-bit I2C address of the lidar sensor
// Found in its manufacturer datasheet
#define LIDAR_ADDR              0x67
#define LIDAR_REG_CFG_ADDR      0x10
#define LIDAR_BUF_VALUE_ADDR    0x4C

// Allowed values for the PVAL bits of the CFG register on the lidar
enum {
    SQ = 0x00,
    LQ = 0x01,
    MQ = 0x02,
    HQ = 0x03
} LIDAR_REG_CFG_PVAL;

// Allowed values for the EN bit of the CFG register on the lidar
enum {
    DISABLE = 0x00,
    ENABLE = 0x01
} LIDAR_REG_CFG_EN;

// Allowed values for the ITR bit of the CFG register on the lidar
enum {
    DISABLE = 0x00,
    ENABLE = 0x01
} LIDAR_REG_CFG_ITR;

// Global union with convenient structure for accessing bitfields
// rather than defining a gazillion bitmasks
union {
    struct {
        uint8_t PVAL0  : 2;
        uint8_t unused : 1;
        uint8_t PVAL1  : 2;
        uint8_t unused : 1;
        uint8_t EN     : 1;
        uint8_t ITR    : 1;
    } field;
    uint8_t all;
} LIDAR_REG_CFG = {.all = 0};

// Global union for accessing the individual bytes of a 32-bit int sensor reading
union {
    uint8_t byte[4];
    int32_t value;
} LIDAR_BUF_VALUE {.value = 0};

// Function declarations
bool lidarInit();
bool lidarSetLowRes();
bool lidarSetHighRes();
bool lidarReadValue();
</code></pre>

<p>lidar.c</p>

<pre><code class="language-c">
bool lidarInit() {
    // Initialize with PVAL0 high quality, PVAL1 standard quality, enable, no interrupt
    LIDAR_REG_CFG.field.PVAL0 = LIDAR_REG_CFG_PVAL.HQ;
    LIDAR_REG_CFG.field.PVAL1 = LIDAR_REG_CFG_PVAL.SQ;
    LIDAR_REG_CFG.field.EN    = LIDAR_REG_CFG_EN.ENABLE;
    LIDAR_REG_CFG.field.ITR   = LIDAR_REG_CFG_ITR.DISABLE;

    // Write the desired configuration to the appropraite register on the lidar
    if (!i2cWriteRegister(LIDAR_ADDR, LIDAR_REG_CFG_ADDR, LIDAR_REG_CFG)) {
        // Return if we failed
        return FALSE;
    }

    // Enable was a success, let's adjust the PVALs to finish
    LIDAR_REG_CFG.field.PVAL0 = LIDAR_REG_CFG_PVAL.MQ;
    LIDAR_REG_CFG.field.PVAL1 = LIDAR_REG_CFG_PVAL.HQ;

    return i2cWriteRegister(LIDAR_ADDR, LIDAR_REG_CFG_ADDR, LIDAR_REG_CFG);
}

bool lidarSetLowRes() {
    LIDAR_REG_CFG.field.PVAL0 = LIDAR_REG_CFG_PVAL.LQ;
    LIDAR_REG_CFG.field.PVAL1 = LIDAR_REG_CFG_PVAL.LQ;

    return i2cWriteRegister(LIDAR_ADDR, LIDAR_REG_CFG_ADDR, LIDAR_REG_CFG);
}

bool lidarSetHighRes() {
    LIDAR_REG_CFG.field.PVAL0 = LIDAR_REG_CFG_PVAL.HQ;
    LIDAR_REG_CFG.field.PVAL1 = LIDAR_REG_CFG_PVAL.HQ;

    return i2cWriteRegister(LIDAR_ADDR, LIDAR_REG_CFG_ADDR, LIDAR_REG_CFG);
}

bool lidarReadValue() {
    return i2cReadRegister(LIDAR_ADDR, LIDAR_BUF_VALUE_ADDR, LIDAR_BUF_VALUE.byte, 4);
}
</code></pre>

<p>auto.c</p>

<pre><code class="language-c">#include &quot;lidar.h&quot;

void autonomous() {
}
</code></pre>

<h2 id="pollingTask">I2C Polling Tasks</h2>

<h2 id="debugging-tips-and-tricks">Debugging Tips and Tricks</h2>

<!---
Sign extension
union/struct method
endianness
-->


			<aside class="copyright" role="note">
				
				&copy; 2016 Released under the MPL 2.0 license &ndash;
				
				Documentation built with
				<a href="https://www.gohugo.io" target="_blank">Hugo</a>
				using the
				<a href="http://github.com/digitalcraftsman/hugo-material-docs" target="_blank">Material</a> theme. <br/>
				Contribute to PROS documentation on <a href="http://github.com/purduesigbots/pros-docs">GitHub</a>!
			</aside>

			<footer class="footer">
				

			</footer>
		</div>
	</article>

	<div class="results" role="status" aria-live="polite">
		<div class="scrollable">
			<div class="wrapper">
				<div class="meta"></div>
				<div class="list"></div>
			</div>
		</div>
	</div>
</main>

    <script>
    
      var base_url = 'http:\/\/pros.cs.purdue.edu\/';
      var repo_id  = 'purduesigbots\/pros';
    
    </script>

    <script src="http://pros.cs.purdue.edu/javascripts/application.js"></script>
    

    <script>
      /* Add headers to scrollspy */
      var headers   = document.getElementsByTagName("h2");
      var scrollspy = document.getElementById('scrollspy');

      if(scrollspy) {
        if(headers.length > 0) {
          for(var i = 0; i < headers.length; i++) {
            var li = document.createElement("li");
            li.setAttribute("class", "anchor");

            var a  = document.createElement("a");
            a.setAttribute("href", "#" + headers[i].id);
            a.setAttribute("title", headers[i].innerHTML);
            a.innerHTML = headers[i].innerHTML;
            
            li.appendChild(a)
            scrollspy.appendChild(li);
          }
        } else {
          scrollspy.parentElement.removeChild(scrollspy)
        }
        

        /* Add permanent link next to the headers */
        var headers = document.querySelectorAll("h1, h2, h3, h4, h5, h6");

        for(var i = 0; i < headers.length; i++) {
            var a = document.createElement("a");
            a.setAttribute("class", "headerlink");
            a.setAttribute("href", "#" + headers[i].id);
            a.setAttribute("title", "Permanent link")
            a.innerHTML = "#";
            headers[i].appendChild(a);
        }
      }
    </script>

    
      <script>
        (function(i,s,o,g,r,a,m){
          i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||
          []).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
          m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;
          m.parentNode.insertBefore(a,m)
        })(window, document,
          'script', '//www.google-analytics.com/analytics.js', 'ga');
         
        ga('create', 'UA-84548828-3', 'auto');
        ga('set', 'anonymizeIp', true);
        ga('send', 'pageview');
         
        var buttons = document.querySelectorAll('a');
        Array.prototype.map.call(buttons, function(item) {
          if (item.host != document.location.host) {
            item.addEventListener('click', function() {
              var action = item.getAttribute('data-action') || 'follow';
              ga('send', 'event', 'outbound', action, item.href);
            });
          }
        });
         
        var query = document.querySelector('.query');
        query.addEventListener('blur', function() {
          if (this.value) {
            var path = document.location.pathname;
            ga('send', 'pageview', path + '?q=' + this.value);
          }
        });
      </script>
    

    <script src="//gohugo.io/js/highlight.pack.js"></script>
    <script>hljs.initHighlightingOnLoad();</script>
  </body>
</html>
